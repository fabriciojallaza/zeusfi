{
  "info": {
    "name": "ZeusFi API",
    "description": "ZeusFi Cross-Chain Yield Farming Agent API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "jwt_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "wallet_address",
      "value": "0x742d35Cc6634C0532925a3b844Bc9e7595f5bE91",
      "type": "string",
      "description": "Test wallet address (use your own)"
    },
    {
      "key": "nonce",
      "value": "",
      "type": "string"
    },
    {
      "key": "siwe_message",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health & Setup",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/v1/parameters/health/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "parameters", "health", ""]
            },
            "description": "Check if the server is running and DB/Redis are connected"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Authentication",
      "item": [
        {
          "name": "1. Get Nonce",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "pm.collectionVariables.set('nonce', jsonData.nonce);",
                  "pm.collectionVariables.set('siwe_message', jsonData.message);",
                  "console.log('Nonce:', jsonData.nonce);",
                  "console.log('Message to sign:', jsonData.message);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"wallet_address\": \"{{wallet_address}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/auth/nonce/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "auth", "nonce", ""]
            },
            "description": "Step 1: Get a nonce and SIWE message to sign.\n\nAfter this, you need to sign the returned 'message' with your wallet (MetaMask, ethers.js, etc.)"
          },
          "response": [
            {
              "name": "Success",
              "status": "OK",
              "code": 200,
              "body": "{\n    \"nonce\": \"a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6\",\n    \"message\": \"ZeusFi wants you to sign in with your Ethereum account:\\n0x742d35Cc6634C0532925a3b844Bc9e7595f5bE91\\n\\nSign in to ZeusFi yield farming agent.\\n\\nURI: https://zeusfi.xyz\\nVersion: 1\\nChain ID: 1\\nNonce: a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6\\nIssued At: 2024-01-15T10:30:00.000Z\",\n    \"expires_at\": \"2024-01-15T10:35:00.000Z\"\n}"
            }
          ]
        },
        {
          "name": "2. Verify Signature",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "if (jsonData.token) {",
                  "    pm.collectionVariables.set('jwt_token', jsonData.token);",
                  "    console.log('JWT Token saved!');",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"wallet_address\": \"{{wallet_address}}\",\n    \"message\": \"{{siwe_message}}\",\n    \"signature\": \"0xYOUR_SIGNATURE_HERE\",\n    \"nonce\": \"{{nonce}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/auth/verify/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "auth", "verify", ""]
            },
            "description": "Step 2: Verify the signed message.\n\nYou need to replace 'signature' with the actual signature from your wallet.\n\nTo sign the message manually (Node.js):\n```javascript\nconst { ethers } = require('ethers');\nconst wallet = new ethers.Wallet('YOUR_PRIVATE_KEY');\nconst signature = await wallet.signMessage(message);\nconsole.log(signature);\n```"
          },
          "response": [
            {
              "name": "Success",
              "status": "OK",
              "code": 200,
              "body": "{\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n    \"wallet\": {\n        \"address\": \"0x742d35cc6634c0532925a3b844bc9e7595f5be91\",\n        \"ens_name\": null,\n        \"created_at\": \"2024-01-15T10:30:00.000Z\",\n        \"ens_min_apy\": null,\n        \"ens_max_risk\": null,\n        \"ens_chains\": [],\n        \"ens_protocols\": [],\n        \"ens_auto_rebalance\": false,\n        \"ens_updated_at\": null,\n        \"vaults\": []\n    }\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "Wallet",
      "item": [
        {
          "name": "Get Wallet Info",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/wallet/{{wallet_address}}/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wallet", "{{wallet_address}}", ""]
            },
            "description": "Get wallet details including vaults and ENS preferences"
          },
          "response": [
            {
              "name": "Success",
              "status": "OK",
              "code": 200,
              "body": "{\n    \"address\": \"0x742d35cc6634c0532925a3b844bc9e7595f5be91\",\n    \"ens_name\": \"alice.eth\",\n    \"created_at\": \"2024-01-15T10:30:00.000Z\",\n    \"ens_min_apy\": \"5.00\",\n    \"ens_max_risk\": \"medium\",\n    \"ens_chains\": [\"base\", \"arbitrum\"],\n    \"ens_protocols\": [\"aave\", \"morpho\"],\n    \"ens_auto_rebalance\": true,\n    \"ens_updated_at\": \"2024-01-15T10:00:00.000Z\",\n    \"vaults\": [\n        {\n            \"id\": 1,\n            \"chain_id\": 8453,\n            \"chain_name\": \"base\",\n            \"vault_address\": \"0x1234...\",\n            \"is_active\": true,\n            \"created_at\": \"2024-01-15T10:30:00.000Z\"\n        }\n    ]\n}"
            }
          ]
        },
        {
          "name": "Register Vault",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"chain_id\": 8453,\n    \"vault_address\": \"0x1234567890123456789012345678901234567890\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/wallet/register-vault/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "wallet", "register-vault", ""]
            },
            "description": "Register a vault address for the authenticated wallet.\n\nchain_id options:\n- 8453 = Base\n- 42161 = Arbitrum\n- 43114 = Avalanche"
          },
          "response": [
            {
              "name": "Success",
              "status": "Created",
              "code": 201,
              "body": "{\n    \"id\": 1,\n    \"chain_id\": 8453,\n    \"chain_name\": \"base\",\n    \"vault_address\": \"0x1234567890123456789012345678901234567890\",\n    \"is_active\": true,\n    \"created_at\": \"2024-01-15T10:30:00.000Z\"\n}"
            }
          ]
        }
      ]
    },
    {
      "name": "Yields",
      "item": [
        {
          "name": "List All Yields",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/yields/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "yields", ""]
            },
            "description": "List all yield pools.\n\nRun the Celery task first to populate data:\n```python\nfrom apps.yields.tasks import fetch_yields\nfetch_yields()\n```"
          },
          "response": []
        },
        {
          "name": "List Yields (Filtered)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/yields/?chain=base&project=aave-v3&min_apy=3&max_risk=5",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "yields", ""],
              "query": [
                {
                  "key": "chain",
                  "value": "base",
                  "description": "Filter by chain: base, arbitrum, avalanche"
                },
                {
                  "key": "project",
                  "value": "aave-v3",
                  "description": "Filter by protocol: aave-v3, morpho, euler"
                },
                {
                  "key": "min_apy",
                  "value": "3",
                  "description": "Minimum APY percentage"
                },
                {
                  "key": "max_risk",
                  "value": "5",
                  "description": "Maximum risk score (1-10)"
                },
                {
                  "key": "chain_id",
                  "value": "8453",
                  "description": "Filter by chain ID",
                  "disabled": true
                },
                {
                  "key": "min_tvl",
                  "value": "1000000",
                  "description": "Minimum TVL in USD",
                  "disabled": true
                }
              ]
            },
            "description": "List yield pools with filters"
          },
          "response": []
        },
        {
          "name": "Get Yield Pool Details",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/yields/747c1d2a-c668-4682-b9f9-296708a3dd90/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "yields", "747c1d2a-c668-4682-b9f9-296708a3dd90", ""]
            },
            "description": "Get details of a specific yield pool.\n\nReplace the pool_id with an actual ID from the list endpoint."
          },
          "response": []
        },
        {
          "name": "Get Best Yields (Per User Prefs)",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/yields/best/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "yields", "best", ""]
            },
            "description": "Get the best yield pool per chain, filtered by user's ENS preferences"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Positions",
      "item": [
        {
          "name": "Get Positions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/positions/{{wallet_address}}/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "positions", "{{wallet_address}}", ""]
            },
            "description": "Get current positions for a wallet.\n\nNote: Will be empty until positions are tracked (agent implementation)."
          },
          "response": [
            {
              "name": "Success (Empty)",
              "status": "OK",
              "code": 200,
              "body": "{\n    \"total_value_usd\": \"0\",\n    \"average_apy\": \"0\",\n    \"positions\": [],\n    \"by_chain\": {},\n    \"by_protocol\": {}\n}"
            },
            {
              "name": "Success (With Positions)",
              "status": "OK",
              "code": 200,
              "body": "{\n    \"total_value_usd\": \"10000.00\",\n    \"average_apy\": \"5.5000\",\n    \"positions\": [\n        {\n            \"id\": 1,\n            \"vault_address\": \"0x1234...\",\n            \"chain_id\": 8453,\n            \"chain_name\": \"base\",\n            \"protocol\": \"aave-v3\",\n            \"token\": \"USDC\",\n            \"amount\": \"10000000000\",\n            \"amount_usd\": \"10000.00\",\n            \"current_apy\": \"5.5000\",\n            \"updated_at\": \"2024-01-15T10:30:00.000Z\"\n        }\n    ],\n    \"by_chain\": {\n        \"base\": {\"value_usd\": \"10000.00\"}\n    },\n    \"by_protocol\": {\n        \"aave-v3\": {\"value_usd\": \"10000.00\"}\n    }\n}"
            }
          ]
        },
        {
          "name": "Get Rebalance History",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/positions/{{wallet_address}}/history/?limit=50&offset=0",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "positions", "{{wallet_address}}", "history", ""],
              "query": [
                {
                  "key": "limit",
                  "value": "50",
                  "description": "Number of records to return"
                },
                {
                  "key": "offset",
                  "value": "0",
                  "description": "Pagination offset"
                },
                {
                  "key": "status",
                  "value": "success",
                  "description": "Filter by status: pending, submitted, success, failed",
                  "disabled": true
                },
                {
                  "key": "chain_id",
                  "value": "8453",
                  "description": "Filter by chain ID",
                  "disabled": true
                }
              ]
            },
            "description": "Get rebalance history for a wallet"
          },
          "response": []
        },
        {
          "name": "Get Rebalance Details",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/v1/positions/{{wallet_address}}/history/1/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "positions", "{{wallet_address}}", "history", "1", ""]
            },
            "description": "Get details of a specific rebalance.\n\nReplace '1' with an actual rebalance ID."
          },
          "response": []
        },
        {
          "name": "Get LI.FI Quote",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"from_chain\": 8453,\n    \"from_token\": \"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913\",\n    \"from_amount\": \"1000000000\",\n    \"to_chain\": 42161,\n    \"to_token\": \"0xaf88d065e77c8cC2239327C5EDb3A432268e5831\",\n    \"vault_address\": \"0x1234567890123456789012345678901234567890\",\n    \"slippage\": 0.03\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/positions/quote/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "positions", "quote", ""]
            },
            "description": "Get a LI.FI quote for cross-chain movement.\n\nNote: You must have a registered vault first.\n\nToken addresses (USDC):\n- Base: 0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913\n- Arbitrum: 0xaf88d065e77c8cC2239327C5EDb3A432268e5831\n- Avalanche: 0xB97EF9Ef8734C71904D8002F8b6Bc66Dd9c48a6E\n\nFor Aave aUSDC deposits (use as to_token):\n- Base: 0x4e65fE4DbA92790696d040ac24Aa414708F5c0AB\n- Arbitrum: 0x724dc807b04555b71ed48a6896b6F41593b8C637\n- Avalanche: 0x625E7708f30cA75bfd92586e17077590C60eb4cD\n\nAmount is in smallest unit (1000000000 = 1000 USDC with 6 decimals)"
          },
          "response": [
            {
              "name": "Success",
              "status": "OK",
              "code": 200,
              "body": "{\n    \"quote_id\": \"abc123\",\n    \"type\": \"lifi\",\n    \"tool\": \"stargate\",\n    \"is_cross_chain\": true,\n    \"from_chain\": 8453,\n    \"from_token\": \"USDC\",\n    \"from_amount\": \"1000000000\",\n    \"to_chain\": 42161,\n    \"to_token\": \"USDC\",\n    \"to_amount\": \"998500000\",\n    \"to_amount_min\": \"968545000\",\n    \"gas_cost_usd\": \"2.50\",\n    \"execution_duration\": 120,\n    \"transaction_request\": {\n        \"to\": \"0x1231DEB6f5749EF6cE6943a275A1D3E7486F4EaE\",\n        \"data\": \"0x...\",\n        \"value\": \"0\",\n        \"gas_limit\": \"500000\",\n        \"chain_id\": 8453\n    }\n}"
            }
          ]
        },
        {
          "name": "Execute Rebalance",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{jwt_token}}"
              },
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"from_chain\": 8453,\n    \"from_token\": \"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913\",\n    \"from_amount\": \"1000000000\",\n    \"to_chain\": 42161,\n    \"to_token\": \"0x724dc807b04555b71ed48a6896b6F41593b8C637\",\n    \"vault_address\": \"0x1234567890123456789012345678901234567890\",\n    \"slippage\": 0.03,\n    \"from_protocol\": \"aave-v3\",\n    \"to_protocol\": \"aave-v3\",\n    \"from_apy\": \"4.5\",\n    \"to_apy\": \"6.2\",\n    \"agent_reasoning\": \"Moving funds to higher yield on Arbitrum\",\n    \"async\": false\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/v1/positions/rebalance/",
              "host": ["{{base_url}}"],
              "path": ["api", "v1", "positions", "rebalance", ""]
            },
            "description": "Execute a rebalance via LI.FI.\n\nThis endpoint:\n1. Gets a LI.FI quote\n2. Executes the transaction via Agent Wallet\n3. Waits for completion\n4. Records in RebalanceHistory\n\n**IMPORTANT**: Requires AGENT_WALLET_PRIVATE_KEY to be set in environment.\n\nSet async=true to queue for background execution.\n\nFor Aave deposits, use aUSDC as to_token:\n- Base: 0x4e65fE4DbA92790696d040ac24Aa414708F5c0AB\n- Arbitrum: 0x724dc807b04555b71ed48a6896b6F41593b8C637\n- Avalanche: 0x625E7708f30cA75bfd92586e17077590C60eb4cD"
          },
          "response": [
            {
              "name": "Success (Sync)",
              "status": "OK",
              "code": 200,
              "body": "{\n    \"rebalance_id\": 1,\n    \"status\": \"success\",\n    \"tx_hash\": \"0x123...\",\n    \"from_amount\": \"1000000000\",\n    \"to_amount\": \"998500000\",\n    \"tool\": \"stargate\"\n}"
            },
            {
              "name": "Accepted (Async)",
              "status": "Accepted",
              "code": 202,
              "body": "{\n    \"rebalance_id\": 1,\n    \"status\": \"pending\",\n    \"message\": \"Rebalance queued for execution\"\n}"
            }
          ]
        }
      ]
    }
  ]
}
